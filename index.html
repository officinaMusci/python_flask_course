<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Python Course</title>

        <link rel="stylesheet" href="dist/reset.css">
        <link rel="stylesheet" href="dist/reveal.css">
        <link rel="stylesheet" href="dist/theme/black.css">

        <style>
            body {
                cursor: url(media/cursor.png), auto;
            }
            a {
                font-size: 15px;
                margin: auto 0 0 auto;
            }
            li {
                font-size: 20px;
                margin-bottom: 20px;
            }
            .container {
                display: flex;
            }
            .col {
                flex: 1;
            }

            .column-list {
                columns: 100px;
            }
        </style>

        <!-- Theme used for syntax highlighted code -->
        <link rel="stylesheet" href="plugin/highlight/monokai.css">
    </head>

    <body>
        <div class="reveal">
            <div class="slides">

        <section>

            <section>

                <p>Flask</p>
            </section>


            <section>

                <p><small>
                    Flask est un micro framework web √©crit en Python ;<br>
                    voici ses principales caract√©ristiques :
                </small></p>

                <ul>
                    <li>Ultra l√©ger</li>
                    <li>Rapide √† apprendre et √† utiliser</li>
                    <li>
                        <strong>Dynamique :</strong><br>
                        <em>permet de cr√©er des simples pages HTML et des REST API complexes</em>
                    </li>
                    <li>
                        <strong>Flexible :</strong><br>
                        <em>il peut √™tre √©tendu via des librairies et des modules</em>
                    </li>
                    <li>Maintenu par une grande communaut√© de d√©veloppeurs</li>
                </ul>
            </section>


            <section>

                <p><small>Qui utilise Flask ?</small></p>

                <ul>
                    <li>Netflix</li>
                    <li>Reddit</li>
                    <li>AirBnB</li>
                    <li>Lyft</li>
                    <li>Mozilla</li>
                    <li>Uber</li>
                    <li><em>Bient√¥t vous aussi</em></li>
                </ul>
            </section>


            <section>
            <h3>La mise en place</h3>
            <pre><code class='language-python'             data-trim data-noescape             data-line-numbers='1-6|8-15'>
        
        
                '''Fichier "app.py" √† la racine du projet'''
                # 1. On importe le module Flask
                import flask

                # 2. On d√©clare la variable globale pour l'application
                app = flask.Flask(__name__)

                # 3. On lance le serveur en mode dev pour avoir le debug
                &gt;&gt;&gt; export FLASK_ENV=development
                &gt;&gt;&gt; flask run

                # 3.b Si on utilise un fichier diff√©rent (hello.py) :
                &gt;&gt;&gt; export FLASK_ENV=development
                &gt;&gt;&gt; export FLASK_APP=hello
                &gt;&gt;&gt; flask run

        
                    </code></pre>
            </section>


            <section>
            <h3>Les routes</h3>
            <pre><code class='language-python'             data-trim data-noescape             data-line-numbers='4-7|9-15|17-20|22-25|27-30'>
        
        
                import flask
                app = flask.Flask(__name__)

                # Une route est expos√©e par ce d√©corateur :
                @app.route('/endpoint', methods=['GET', 'POST'])
                def my_endpoint():
                    '''ü§ñ'''

                # Si plusieurs routes doivent pointer vers le m√™me output
                @app.route('/')
                @app.route('/home', methods=['GET', 'POST'])
                @app.route('/index')
                @app.route('/index-post', methods=['POST'])
                def home():
                    '''ü§ñ'''

                # La route peut passer des arguments √† la fonction
                @app.route('/books/&lt;title&gt;')
                def books(title):
                    '''ü§ñ'''

                # ... pr√©ciser les types
                @app.route('/articles/&lt;int:year&gt;/&lt;int:month&gt;')
                def articles(year, month):
                    '''ü§ñ'''

                # Et la fonction peut en d√©finir les d√©fauts
                @app.route('/reviews/&lt;int:year&gt;/&lt;int:month&gt;/&lt;str:title&gt;')
                def reviews(year=2021, month=12, title=None):
                    '''ü§ñ'''

        
                    </code></pre>
            </section>


            <section>
            <h3>L'objet requ√™te</h3>
            <pre><code class='language-python'             data-trim data-noescape             data-line-numbers='1-3|7-17'>
        
        
                # Pour avoir acc√®s au request object, on doit l'importer
                import flask
                from flask import request # üÜï

                app = flask.Flask(__name__)

                # Dans les routes on a acces au request object :
                @app.route('/endpoint')
                def endpoint():
                    request.method  # POST, GET, PUT, DELETE
                    request.args    # Les param√©tres URL (?k=v)
                    request.headers # Les en-t√™tes de la requ√™te

                    # Data re√ßues
                    request.form       # Le contenu du form (si submitted)
                    request.data       # Les data en format byte
                    request.get_json() # Les data lues depuis le JSON
    
        
                    </code></pre>
            </section>


            <section>
            <h3>Les r√©ponses</h3>
            <pre><code class='language-python'             data-trim data-noescape             data-line-numbers='6-17|19-29|31-38|40-41'>
        
        
                import flask
                app = flask.Flask(__name__)

                @app.route('/')
                def home():
                    # A. Gabarit HTML
                    html = flask.render_template(
                        'index.html',
                        title='Bienvenue sur ma page web !',
                        visits=10
                    )

                    response = flask.make_response(
                        html,                  # body
                        200,                   # status
                        {'X-Foo': 'blah blah'} # headers
                    )

                    # B. R√©ponse JSON
                    json = flask.jsonify({
                        'results': [1, 2, 3],
                        'error': None
                    })

                    response = flask.make_response(
                        json,                                 # body
                        200,                                  # status
                        {'Content-Type': 'application/json'}  # headers
                    )

                    # C. R√©direction
                    response = flask.redirect(
                        flask.url_for(
                            'dashboard', # Nom de la fonction
                            visits=11    # /?visits=11 || /&amp;#60;visits=11&amp;#62;
                        ),
                        code=302
                    )

                    # On retourne la r√©ponse
                    return response
        
                    </code></pre>
            </section>


            <section>
                <p>C'est le temps de fabriquer quelque chose !</p>

                <p><small>Cr√©ez une application ¬´ squelettique ¬ª qui servira de base aux prochaines √©tapes.</small></p>
                <p><small>Cette application doit avoir les routes pour les op√©rations suivantes :</small></p>

                <ul>
                    <li>Enregistrer un article</li>
                    <li>Modifier un article</li>
                    <li>Lister tous les articles</li>
                </ul>

                <p><small>Pour les r√©ponses, vous pouvez utiliser la m√©thode JSON et renvoyer des messages positifs pour les op√©rations effectu√©es, m√™me si rien ne se passe r√©ellement !</small></p>
            </section>


            <section>
            <h3>La gestion des erreurs</h3>
            <pre><code class='language-python'             data-trim data-noescape             data-line-numbers='4-16'>
        
        
                import flask
                app = flask.Flask(__name__)

                '''
                Des r√©ponses sp√©cifiques peuvent √™tre retourn√©es
                dans le cas o√π une requ√™te renvoie une erreur
                '''
                @app.errorhandler(404)
                def not_found():
                    '''ü§ñ'''

                @app.errorhandler(400)
                def bad_request():
                    '''ü§ñ'''

                @app.errorhandler(500)
                def server_error():
                    '''ü§ñ'''
        
                    </code></pre>
            </section>

        </section>

    </div>
    	</div>
        <script src="dist/reveal.js"></script>
        <script src="plugin/notes/notes.js"></script>
        <script src="plugin/markdown/markdown.js"></script>
        <script src="plugin/highlight/highlight.js"></script>
        <script>
            // More info about initialization & config:
            // - https://revealjs.com/initialization/
            // - https://revealjs.com/config/
            Reveal.initialize({
                hash: true,
                parallaxBackgroundImage: 'https://background-tiles.com/overview/black/patterns/large/1035.png',
                parallaxBackgroundSize: '300px 300px',
                parallaxBackgroundHorizontal: 200,
                parallaxBackgroundVertical: 50,

                // Learn about plugins: https://revealjs.com/plugins/
                plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
            });
        </script>
    </body>
</html>